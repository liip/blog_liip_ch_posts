Just before Easter I [tweeted](https://twitter.com/lsmith/status/456343361939832832) out an idea that I already threw out there a few weeks ago: Creating a [PHP Content Repository](phpcr.github.io) (PHPCR) implementation on top of the [prismic.io](http://prismic.io) content repository as a service. Well I had a lot of time on the train over Easter, so I decided to make it happen. Obviously coding against a remote service on the train isn't that much fun, so in fact I did a lot of coding, waited for the next train station, hit refresh a few times and so on and on. I briefly tried to setup [php-vcr](https://github.com/php-vcr/php-vcr) to log all web requests and replay them, but unfortunately the library isn't quite ready to do this yet .. but mit might be soon. Also as prismic.io's content pages are actually all versioned we will soon hopefully get caching provided inside their [PHP SDK](https://github.com/prismicio/php-kit/issues/32). But I digress. So without further ado, I present to you an initial working version of [PHPCR integration with prismic.io](https://github.com/jackalope/jackalope-prismic). There are obviously still a ton of todo's left .. fundamentally it works, I can read prismic documents as PHPCR nodes with properties.

### Why bother?

At this point you may either be excited or wondering why I am bothering with this. If you are in the former group, you can maybe skip to the next section, if you are in the later group, let me expand. One reason to bother with this is to simply show its possible, that PHPCR indeed fullfils this promise of being able to provide a unified content repository API. We obviously have 3 implementations already but taking such a service seems to push the boundaries a little harder. The next reason is more practical: prismic.io is simply a very useful service with an awesome user experience, especially for people focused on managing content rather than managing pages on a website. And they are doing this with an awesome UI, argueable the main week spot of the CMF (though I am quite excited about the work by the sulu.io team).

### The sky is the limit?

Now prismic.io has some major differences in how content can be structured compared to plain PHPCR. Specifically they do not really structure their content into a tree per se. Instead they just have a pool of documents with UUIDs. Now it is possible to reference those UUIDs inside documents which kind of creates a tree structure. There is also native support for tagging and finally a way to bookmark document UUIDs to names. In a first step all I did was create a virtual root node that has the entire document pool as children where the names match the bookmark name (if one exists) or the UUID. All properties, including nested documents, are then mapped to properties on those children. Eventually nested documents should however maybe be exposed as child structures. Another limitation is that prismic.io currently only provides a read API. But given their awesome UI, why would one want a write API? ;)

### The sky is the limit!

But there is a lot possible yet. For example they provide a [predicate based query API](https://developers.prismic.io/documentation/UjBe8bGIJ3EKtgBZ/api-documentation#predicate-based-queries) that I am very confident we will be able to map to the PHPCR query languages [SQL2](http://www.h2database.com/jcr/grammar.html)/QOM, similar to how we [map them to SQL with Doctrine DBAL](https://github.com/jackalope/jackalope-doctrine-dbal/blob/master/src/Jackalope/Transport/DoctrineDBAL/Query/QOMWalker.php). They also support versioning, which can probably be mapped to the PHPCR simple versioning concept. They also support node types which I have already mapped but there is still work todo to map all the contraints. They also support custom namespaces which PHPCR also supports. The way they support images (and binaries) also lends itself very nicely to the stream based approach in PHPCR. So with a few more days of work, I think we can provide a pretty powerful PHPCR API for prismic.io. What will make the collaboration easier is that it turns out that [Thibault](https://github.com/ornicar), founding member of the Symfony CMF initative gone Scala-lover, works for [zengularity.com](http://zengularity.com) who created prismic.io. But [Rudy](https://github.com/rudyrigot) was actually the first one to jump on my tweets and he has already signed up to the CMF mailinglist and given [important insights](https://groups.google.com/d/msg/symfony-cmf-devs/mS07m-a-MdA/Q3kt1_3xSUYJ).

### Where to go from here?

I am not sure how much time I will have on this in the coming days. The [CMF 1.1 release](http://cmf.symfony.com/news/finally-1-1-0-RC1) is still the top spot on my open source todo list. I think with what I have setup here, it should be possible for people even without prior knowledge of Jackalope to help out implementing some of the [open items in the issue tracker](https://github.com/jackalope/jackalope-prismic/issues). So I hope that the community chips in as well. Judging from the feedback on twitter, there are quite a few people interested!

PS: As part of my initial playing time with prismic.io, I also [refactored their Symfony2 starter project](https://github.com/prismicio/php-symfony-starter/pull/3) a bit. Might be interesting to take that for a whirl as well before diving into the PHPCR world. They also have a few [open tickets on their PHP SDK](https://github.com/prismicio/php-kit/issues).